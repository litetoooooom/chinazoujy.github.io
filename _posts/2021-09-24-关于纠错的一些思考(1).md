# 关于纠错的一些思考

## 前言 

工作生涯中，似乎每一份工作都和纠错相关。做过英语语法纠错，基于OCR的纠错，基于ASR的纠错，搜索query的纠错。基本上林林总总的翻了网上现有能找到的资料，也上线了各种关于纠错的服务。为了整理和记录，也为了抛砖引玉，写了这些文章。

我将从我最近做的纠错项目说起，由此不断往前，顺带慢慢回忆之前写的纠错项目，毕竟4，5年做的其他纠错很多方法和需要注意的点不一定能想起来，也不一定适用于现在的情况和技术场景。

## 搜索query的纠错

这里的query主要是中文，会参杂少量的英文。

其实搜索query的纠错准确地说应该是“query改写”，query改写包括纠错，还包括query扩展。

首先说说为什么需要对搜索的query进行改写。搜索领域query具有不可控性，可能出现任何你想不到的情形。

从query的产生说起。1. 假定该用户正在使用手机搜索服务。那么使用的输入法包括9键拼音，26键拼音，笔画输入，当前还有一些其他比较小众的输入这里暂不考虑那些情况。而由于不同的输入法产生的错误存在的差别是非常大的，我们不讨论哪种输入法的错误率高这个问题，毕竟即便你统计出了最高错误率的输入法那也不能改变用户的使用习惯。2. 相对应的就有电脑使用搜索服务，双手打字五笔和拼音产生的错误情况又和手机的输入是完全不一样的。

从query的表达说起：

错字情况：

1. 有全拼音的情况，有汉字拼音混合的情况。比如：zhou杰伦，zhoujielun等等，广义上这种情况并不属于错误，但在搜索的领域却需要把它改过来，所以暂按纠错类别处理。

2. 中文字拆分组合。比如“车俞入法”->“输入法”，在实际中，“输”字可能是一个比较生僻的词或者是用户用当前的输入法难以输入的词，也可能是手写输入造成的。这种情况在垂直的搜索领域比较常见，例如医学。

3. 同音字。顾名思义，不做展开

4. 其他。具体的类别需要拆解case

漏字情况：

1. 漏字的情况又分为单漏和多漏。单漏的处理相对比较简单。多漏的处理起来很麻烦。在实际中，漏字错误的情况处理，一般会联系query意图辅助修复。具体方案后续会展开

多字情况：

1. 在实际工程中，针对多字的错误出现，分为两种：意图的连续，意图的分歧。比如：“美丽丽的小花”，其语义没变，但如果多字导致了多语义的歧义性，通常在长句中一般采用上下文，但是在搜索短query中，上下文的信息非常的稀少，这种情况下，一般采用相关搜索词辅助解决。具体方案后续会展开

通常，以上三种类型的错误情况，基本上就是搜索常见的错误了。

## 搜索纠错的应用

搜索引擎中应用纠错的结果主要分为三部分：

1. 高置信度的结果直接替换原query参与检索。比如原query是zhoujielun，直接参与检索的是其汉字

2. 中置信度。提示检索。即我们常用的搜索中，使用query进行查询时，他会提示“已显示某query的结果，是否还按原query进行检索”，用户可自行选择

3. 混合检索。这种情况一般用在query扩展。例如同义词检索等。

## 纠错的解决方案（碎碎念）

一开始接触纠错，和后续的一两年时间里，我都是把纠错当成一个独立的模块来实现。事实证明，这条路是狭窄和崎岖的。真正有效的方案是纠错的解决，是和其他功能互相依赖，且某些情况下，纠错的实现需要转移到其他功能模块中。比如sug, 相关词检索等